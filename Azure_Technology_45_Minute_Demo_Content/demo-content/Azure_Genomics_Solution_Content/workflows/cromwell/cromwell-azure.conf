backend {
  default = "AzureBatch"

  providers {
    AzureBatch {
      actor-factory = "cromwell.backend.impl.azure.AzureBatchBackendLifecycleActorFactory"
      config {
        batch-account = ${BATCH_ACCOUNT}
        batch-url = ${BATCH_URL}
        batch-key = ${BATCH_KEY}

        storage-account = ${STORAGE_ACCOUNT}
        storage-container = ${STORAGE_CONTAINER}
        // Use SAS to avoid storing account key; Cromwell plugin typically supports account key.
        // With SAS, set as env var STORAGE_SAS and append to blob URLs when needed.
        // Some distributions require account key; if so, consider Cromwell on Azure (TES) for MI-native auth.

        docker-enabled = true
        filesystems {
          azure {
            auth = "sas"    // indicative; depends on plugin build
            container = ${STORAGE_CONTAINER}
            account = ${STORAGE_ACCOUNT}
            sas-token = ${STORAGE_SAS}
          }
        }
      }
    }
  }
}